name: dev
run-name: build by ${{ github.actor }} - ${{ github.sha }}
on:
  push:
    branches:
      - 'main'

jobs:
  prepare:
    runs-on: ubuntu-latest
    steps:
      - run: echo "GIT_TAG=`echo ${GITHUB_REF##*/}`" >> $GITHUB_ENV
      - run: echo ${{ env.GIT_TAG }}
    outputs:
      git_tag: ${{ env.GIT_TAG }}
  build_frontend:
    needs: prepare
#    runs-on: ubuntu-latest
#    steps:
#      - run: |
#          echo "${{ needs.prepare.outputs.git_tag }}"

    uses: ./.github/workflows/build.yml
    with:
      GIT_TAG: ${{ needs.prepare.outputs.git_tag }}
    secrets:
      DOCKERHUB_USERNAME: ${{ secrets.DOCKERHUB_USERNAME }}
      DOCKERHUB_TOKEN: ${{ secrets.DOCKERHUB_TOKEN }}